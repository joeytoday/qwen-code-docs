# Режим одобрения

Qwen Code предлагает три различных режима разрешений, которые позволяют гибко контролировать, как ИИ взаимодействует с вашим кодом и системой, в зависимости от сложности задачи и уровня риска.

## Сравнение режимов разрешений

| Режим          | Редактирование файлов       | Команды оболочки            | Для кого подходит                                                                                       | Уровень риска |
| -------------- | --------------------------- | --------------------------- | ------------------------------------------------------------------------------------------------------- | ------------- |
| **Plan**​      | ❌ Только анализ только для чтения | ❌ Не выполняются             | • Исследование кода <br>• Планирование сложных изменений <br>• Безопасный просмотр кода                  | Самый низкий  |
| **Default**​   | ✅ Требуется ручное одобрение | ✅ Требуется ручное одобрение | • Новые/незнакомые кодовые базы <br>• Критические системы <br>• Совместная работа в команде <br>• Обучение и преподавание | Низкий        |
| **Auto-Edit**​ | ✅ Автоматическое одобрение | ❌ Требуется ручное одобрение | • Повседневные задачи разработки <br>• Рефакторинг и улучшение кода <br>• Безопасная автоматизация         | Средний       |
| **YOLO**​      | ✅ Автоматическое одобрение | ✅ Автоматическое одобрение | • Доверенные личные проекты <br>• Автоматизированные скрипты/CI/CD <br>• Задачи пакетной обработки        | Самый высокий |

### Краткое руководство

- **Начинайте в режиме планирования**: Отлично подходит для понимания перед внесением изменений
- **Работайте в стандартном режиме**: Сбалансированный выбор для большинства задач разработки
- **Переключайтесь в режим автокорректировки**: Когда вы вносите много безопасных изменений в код
- **Используйте YOLO с осторожностью**: Только для доверенной автоматизации в контролируемых средах

> [!tip]
>
> Вы можете быстро переключаться между режимами во время сессии, используя **Shift+Tab** (или **Tab** в Windows). Строка состояния терминала показывает ваш текущий режим, так что вы всегда будете знать, какие права доступа имеет Qwen Code.

## 1. Используйте режим планирования для безопасного анализа кода

Режим планирования указывает Qwen Code создавать план, анализируя кодовую базу с помощью операций **только для чтения**, идеально подходит для изучения кодовых баз, планирования сложных изменений или безопасного просмотра кода.

### Когда использовать режим планирования

- **Реализация в несколько шагов**: Когда для вашей функции требуется внести изменения в множество файлов
- **Исследование кода**: Когда вы хотите тщательно изучить кодовую базу перед тем, как что-либо изменять
- **Интерактивная разработка**: Когда вы хотите итеративно корректировать направление с помощью Qwen Code

### Как использовать режим плана

**Включение режима плана во время сеанса**

Вы можете переключиться в режим плана во время сеанса, используя **Shift+Tab** (или **Tab** в Windows), чтобы переключаться между режимами разрешений.

Если вы находитесь в обычном режиме, **Shift+Tab** (или **Tab** в Windows) сначала переключает вас в режим `auto-edits`, что обозначается надписью `⏵⏵ accept edits on` в нижней части терминала. Последующий **Shift+Tab** (или **Tab** в Windows) переключит вас в режим плана, который обозначается `⏸ plan mode`.

**Запуск нового сеанса в режиме плана**

Чтобы начать новый сеанс в режиме плана, используйте `/approval-mode`, затем выберите `plan`

```bash
/approval-mode
```

**Выполнение "безголовых" запросов в режиме плана**

Вы также можете выполнить запрос непосредственно в режиме плана с помощью `-p` или `prompt`:

```bash
qwen --prompt "Что такое машинное обучение?"
```

### Пример: Планирование сложной рефакторизации

```bash
/approval-mode plan
```

```
Мне нужно рефакторить нашу систему аутентификации для использования OAuth2. Создайте подробный план миграции.
```

Qwen Code анализирует текущую реализацию и создает комплексный план. Уточните с помощью последующих запросов:

```
Что насчет обратной совместимости?
Как следует обрабатывать миграцию базы данных?
```

### Настройка режима планирования по умолчанию

```json
// .qwen/settings.json
{
  "permissions": {
    "defaultMode": "plan"
  }
}
```

## 2. Используйте режим по умолчанию для контролируемого взаимодействия

Режим по умолчанию — это стандартный способ работы с Qwen Code. В этом режиме вы полностью контролируете все потенциально рискованные операции — Qwen Code будет запрашивать ваше одобрение перед внесением любых изменений в файлы или выполнением команд оболочки.

### Когда использовать режим по умолчанию

- **Незнакомство с кодовой базой**: Когда вы изучаете незнакомый проект и хотите проявить особую осторожность
- **Критические системы**: При работе с производственным кодом, инфраструктурой или конфиденциальными данными
- **Обучение и преподавание**: Когда вы хотите понять каждый шаг, который делает Qwen Code
- **Совместная работа в команде**: Когда над одной и той же кодовой базой работает несколько человек
- **Комплексные операции**: Когда изменения затрагивают несколько файлов или сложную логику

### Как использовать режим по умолчанию

**Включение режима по умолчанию во время сессии**

Вы можете переключиться в режим по умолчанию во время сессии, используя **Shift+Tab** (или **Tab** в Windows), чтобы переключаться между режимами разрешений. Если вы находитесь в любом другом режиме, нажатие **Shift+Tab** (или **Tab** в Windows) в конечном итоге вернет вас к режиму по умолчанию, который обозначается отсутствием индикатора режима в нижней части терминала.

**Запуск новой сессии в режиме по умолчанию**

Режим по умолчанию — это начальный режим при запуске Qwen Code. Если вы изменили режимы и хотите вернуться к режиму по умолчанию, используйте:

```
/approval-mode default
```

**Выполнение безголовых запросов в режиме по умолчанию**

При выполнении безголовых команд поведение по умолчанию соответствует режиму по умолчанию. Вы можете явно указать его с помощью:

```
qwen --prompt "Проанализировать этот код на наличие потенциальных ошибок"
```

### Пример: Безопасная реализация функции

```
/approval-mode default
```

```
Мне нужно добавить изображения профилей пользователей в наше приложение. Изображения должны храниться в бакете S3, а URL-адреса сохраняться в базе данных.
```

Qwen Code проанализирует ваш код и предложит план. Затем он запросит подтверждение перед:

1. Созданием новых файлов (контроллеров, моделей, миграций)
2. Изменением существующих файлов (добавление новых столбцов, обновление API)
3. Выполнением любых команд оболочки (миграции базы данных, установка зависимостей)

Вы можете просмотреть каждое предложенное изменение и одобрить или отклонить его по отдельности.

### Настройка режима по умолчанию как режима по умолчанию

```bash
// .qwen/settings.json
{
  "permissions": {
    "defaultMode": "default"
  }
}
```

## 3. Режим автоматических правок

Режим автоматических правок указывает Qwen Code автоматически одобрять изменения файлов, требуя ручного подтверждения для команд оболочки, что идеально подходит для ускорения рабочих процессов разработки при сохранении безопасности системы.

### Когда использовать режим автоприема изменений

- **Ежедневная разработка**: Идеально подходит для большинства задач программирования
- **Безопасная автоматизация**: Позволяет ИИ изменять код, предотвращая случайное выполнение опасных команд
- **Совместная работа в команде**: Используйте в общих проектах, чтобы избежать непреднамеренного влияния на других участников

### Как переключиться в этот режим

```

# Переключение через команду
/approval-mode auto-edit

# Или используйте сочетание клавиш
Shift+Tab (или Tab в Windows) # Переключение из других режимов
```

### Пример рабочего процесса

1. Вы просите Qwen Code рефакторить функцию
2. ИИ анализирует код и предлагает изменения
3. **Автоматически** применяет все изменения в файлах без подтверждения
4. Если нужно запустить тесты, он **запросит одобрение** для выполнения `npm test`

## 4. Режим YOLO - Полная автоматизация

Режим YOLO предоставляет Qwen Code самые высокие разрешения, автоматически одобряя все вызовы инструментов, включая редактирование файлов и команды оболочки.

### Когда использовать режим YOLO

- **Автоматизированные скрипты**: Выполнение предопределенных автоматизированных задач
- **CI/CD пайплайны**: Автоматическое выполнение в контролируемых средах
- **Личные проекты**: Быстрая итерация в полностью доверенных средах
- **Пакетная обработка**: Задачи, требующие многоступенчатых командных цепочек

> [!warning]
>
> **Используйте режим YOLO с осторожностью**: ИИ может выполнить любую команду с правами доступа вашего терминала. Убедитесь:
>
> 1. Что вы доверяете текущей кодовой базе
> 2. Что вы понимаете все действия, которые будет выполнять ИИ
> 3. Что важные файлы сохранены или зафиксированы в системе контроля версий

### Как включить режим YOLO

```

# Временно включить (только для текущей сессии)
/approval-mode yolo

# Установить как проект по умолчанию
/approval-mode yolo --project

# Установить как глобальный пользовательский режим по умолчанию
/approval-mode yolo --user
```

### Пример конфигурации

```bash
// .qwen/settings.json
{
  "permissions": {
    "defaultMode": "yolo",
    "confirmShellCommands": false,
    "confirmFileEdits": false
  }
}
```

### Пример автоматизированного рабочего процесса

```bash

```

# Полностью автоматизированная задача рефакторинга
qwen --prompt "Запустить тестовый набор, исправить все неудачные тесты, затем зафиксировать изменения"

# Без вмешательства человека ИИ будет:

# 1. Запускать команды тестирования (автоматическое одобрение)

# 2. Исправлять неудачные тестовые случаи (автоматическое редактирование файлов)

# 3. Выполнять фиксацию git (автоматическое одобрение)
```

## Переключение режимов и настройка

### Переключение с помощью сочетания клавиш

Во время сеанса Qwen Code используйте **Shift+Tab**​ (или **Tab** в Windows), чтобы быстро переключаться между тремя режимами:

```
Режим по умолчанию → Режим автоскрытия → Режим YOLO → Режим планирования → Режим по умолчанию
```

### Постоянная настройка

```
// На уровне проекта: ./.qwen/settings.json
// На уровне пользователя: ~/.qwen/settings.json
{
  "permissions": {
"defaultMode": "auto-edit",  // или "plan" или "yolo"
"confirmShellCommands": true,
"confirmFileEdits": true
  }
}
```

### Рекомендации по использованию режимов

1. **Новичок в кодовой базе**: Начните с **Режима планирования** для безопасного изучения
2. **Ежедневные задачи разработки**: Используйте **Автоматическое принятие изменений** (режим по умолчанию), эффективный и безопасный
3. **Автоматизированные скрипты**: Используйте **YOLO-режим** в контролируемых средах для полной автоматизации
4. **Комплексная рефакторизация**: Используйте сначала **Режим планирования** для детального планирования, затем переключитесь на соответствующий режим для выполнения